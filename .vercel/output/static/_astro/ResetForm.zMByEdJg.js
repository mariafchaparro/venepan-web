import{d as r,y as v}from"./hooks.module.DKr0xz_Z.js";import{s as p}from"./supabase.CZ8dNI_j.js";import{u as e}from"./jsxRuntime.module.N7e_s17M.js";import"./preact.module.CMz4SUKz.js";import"./_commonjsHelpers.Bx2EM-6T.js";import"./preload-helper.BlTxHScW.js";function L(){const[t,f]=r(""),[c,g]=r(""),[l,w]=r(!1),[i,x]=r(!1),[d,s]=r(""),[m,u]=r(""),[h,o]=r(!1);v(()=>{(async()=>{const{data:{session:n}}=await p.auth.getSession();n||s("El enlace de recuperación ha expirado o es inválido")})()},[]);const b=async a=>{if(a.preventDefault(),o(!0),s(""),u(""),!t||!c){s("Por favor completa todos los campos"),o(!1);return}if(t.length<6){s("La contraseña debe tener al menos 6 caracteres"),o(!1);return}if(t!==c){s("Las contraseñas no coinciden"),o(!1);return}const{error:n}=await p.auth.updateUser({password:t});n?(s("Error al actualizar la contraseña: "+n.message),o(!1)):(u("Contraseña actualizada exitosamente"),setTimeout(()=>{window.location.href="/dashboard"},2e3))};return e("section",{className:"relative flex justify-center items-center h-dvh w-dvw bg-white",children:[e("div",{className:"absolute top-5 left-3 flex items-center",children:[e("img",{src:"/icons/chevron-left.svg",alt:"Flecha atrás",className:"w-4"}),e("a",{href:"/login",className:"text-gray-600 text-sm hover:underline",children:"Volver al Login"})]}),e("div",{className:"flex flex-col items-center justify-center bg-white p-8 gap-10",children:[e("img",{src:"/icons/logo.svg",alt:"Venepan Logo",className:"w-20"}),e("div",{className:"flex flex-col justify-center items-center gap-2",children:[e("h1",{className:"text-gray-800 font-semibold text-3xl text-center",children:"Nueva Contraseña"}),e("p",{className:"text-gray-600 mb-0 w-[40ch] text-center",children:"Ingresa tu nueva contraseña"})]}),e("form",{onSubmit:b,className:"flex flex-col gap-6 w-80",children:[d&&e("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:d}),m&&e("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded",children:m}),e("div",{className:"relative",children:e("input",{id:"password",type:l?"text":"password",placeholder:"Nueva contraseña",value:t,onInput:a=>f(a.target.value),className:"border-b-2 border-light-gray p-3 w-full focus:border-primary outline-none",required:!0})}),e("div",{className:"relative",children:e("input",{id:"confirmPassword",type:i?"text":"password",placeholder:"Confirmar contraseña",value:c,onInput:a=>g(a.target.value),className:"border-b-2 border-light-gray p-3 w-full focus:border-primary outline-none",required:!0})}),e("div",{className:"flex flex-col gap-2",children:[e("label",{htmlFor:"show-password",className:"text-gray-800 text-sm flex items-center gap-1",children:[e("input",{id:"show-password",type:"checkbox",checked:l,onChange:a=>w(a.target.checked)}),"Mostrar nueva contraseña"]}),e("label",{htmlFor:"show-confirm-password",className:"text-gray-800 text-sm flex items-center gap-1",children:[e("input",{id:"show-confirm-password",type:"checkbox",checked:i,onChange:a=>x(a.target.checked)}),"Mostrar confirmación"]})]}),e("button",{type:"submit",disabled:h,className:"btn disabled:opacity-50 mt-4",children:h?"Actualizando...":"Actualizar Contraseña"})]})]})]})}export{L as default};
